<?xml version="1.0" encoding="utf-8" ?>
<!--
    Copyright 2019-2020 Brainbean Apps (https://brainbeanapps.com)
    Copyright 2019-2020 Dataplug (https://dataplug.io)
    License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
-->
<odoo>
    <record model="ir.ui.view" id="view_account_journal_form">
        <field name="name">account.journal.form</field>
        <field name="model">account.journal</field>
        <field name="inherit_id" ref="account.view_account_journal_form" />
        <field name="arch" type="xml">
            <page name="bank_account" position="inside">
                <group
                    name="online_bank_statements"
                    string="Online Bank Statements (OCA)"
                    groups="account.group_account_user"
                    attrs="{'invisible': [('bank_statements_source', '!=', 'online')]}"
                >
                    <label
                        for="online_bank_statement_provider"
                        string="Provider"
                        attrs="{'required': [('bank_statements_source', '=', 'online')]}"
                        class="oe_edit_only"
                        groups="account.group_account_user"
                    />
                    <field
                        name="online_bank_statement_provider"
                        nolabel="1"
                        attrs="{'required': [('bank_statements_source', '=', 'online')]}"
                        class="oe_edit_only"
                        groups="account.group_account_user"
                        widget="dynamic_dropdown"
                        values="values_online_bank_statement_provider"
                    />
                    <label
                        for="online_bank_statement_provider_id"
                        string="Provider"
                        attrs="{'invisible': [('online_bank_statement_provider_id', '=', False)]}"
                        class="oe_read_only"
                    />
                    <field
                        name="online_bank_statement_provider_id"
                        nolabel="1"
                        attrs="{'invisible': [('online_bank_statement_provider_id', '=', False)]}"
                        class="oe_read_only"
                    />
                </group>
            </page>
            <xpath expr="/form/sheet" position="before">
                    <header>
                    <button
                        type="action"
                        name="%(online_bank_statement_pull_wizard_action)d"
                        attrs="{'invisible': ['|', ('bank_statements_source', '!=', 'online'), ('online_bank_statement_provider', '=', False)]}"
                        string="Pull Online Bank Statement"
                    />
                </header>
            </xpath>
        </field>
    </record>
    <record
        id="action_online_bank_statements_pull_wizard"
        model="ir.actions.act_window"
    >
        <field name="name">Online Bank Statements Pull Wizard</field>
        <field name="res_model">online.bank.statement.pull.wizard</field>
        <field name="target">new</field>
        <field name="view_mode">form</field>
        <field name="binding_model_id" ref="account.model_account_journal" />
        <field name="binding_view_types">list</field>
        <field name="groups_id" eval="[(4, ref('account.group_account_user'))]" />
    </record>
</odoo>
