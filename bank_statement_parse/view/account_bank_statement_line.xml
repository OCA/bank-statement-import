<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="view_bank_statement_line_tree">
            <field name="name">Bank statement line tree view</field>
            <field name="model">account.bank.statement.line</field>
            <field name="arch" type="xml">
                <tree
                    string="Statement lines"
                    colors="black:state == 'confirmed';darkmagenta:match_multi == True;crimson:duplicate == True;grey:state=='draft';"
                >
                    <field name="sequence" readonly="1" invisible="1"/>
                    <field name="date"/>
                    <field name="name"/>
                    <field name="ref"/>
                    <field name="partner_id" on_change="onchange_partner_id(partner_id)"/>
                    <field name="link_partner_ok" invisible="1" />
                    <button name="link_partner"
                            string="Link partner"
                            icon="terp-partner"
                            type="object"
                            attrs="{'invisible': [('link_partner_ok', '=', False)]}"
                    />
                    <!-- TODO set partner_id when partner_bank_id changes -->
                    <field name="partner_bank_id"/>
                    <field name="type" on_change="onchange_type(partner_id, type)"/>
                    <!-- TODO note the references to parent from the statement form view -->
                    <field domain="[('journal_id','=',parent.journal_id)]"
                        attrs="{'readonly': ['|', ('state', '!=', 'draft'), ('match_type', '!=', '')]}" name="account_id"/>
                    <field name="analytic_account_id"
                        groups="analytic.group_analytic_accounting"
                        domain="[('company_id', '=', parent.company_id), ('type', '&lt;&gt;', 'view')]"
                    />
                    <field name="amount"/>
                    <field name="match_type"/>
                    <field name="residual"/>
                    <field name="parent_id" invisible="1" />
                    <button name="match_wizard" states="draft"
                            string="Match"
                            icon="terp-gtk-jump-to-ltr"
                            attrs="{'invisible': ['|', ('parent_id', '!=', False),
                                                       ('state', '!=', 'draft')]}"
                            type="object"
                            />
                    <field name="match_multi" invisible="1"/>
                    <field name="duplicate" invisible="1"/>
                    <field name="state"/>
                    <button name="confirm" states="draft"
                            string="Confirm transaction"
                            icon="gtk-ok"
                            type="object"/>
                    <button name="cancel" states="confirmed"
                            string="Cancel transaction"
                            icon="gtk-cancel"
                            type="object"/>
                    <field name="invoice_id"/>
                    <field name="reconcile_id"/>
                </tree>
            </field>
        </record>

	<!-- search view for bank statement lines -->
        <record id="view_account_bank_statement_line_search" model="ir.ui.view">
            <field name="name">account.bank.statement.line.search</field>
            <field name="model">account.bank.statement.line</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Bank Transactions ">
                    <group>
                        <filter
                            string="Draft"
                            domain="[('state','=','draft')]"
                            icon="terp-camera_test"
                        />
                        <filter
                            string="Confirmed"
                            domain="[('state','=','confirmed')]"
                            icon="terp-dialog-close"
                        />
                        <separator orientation="vertical"/>
                        <field name="ref"/>
                        <field name="type"/>
                        <field name="period_id"/>
                    </group>
                    <newline/>
                    <group>
                        <field name="date"/>
                        <field name="partner_id"/>
                        <field name="partner_bank_id"/>
                        <field name="account_id"/>
                    </group>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter
                            string="State"
                            context="{'group_by': 'state'}"
                            icon="terp-stock_effects-object-colorize"
                        />
                    </group>
                </search>
            </field>
        </record>

     </data>
</openerp>
